dists=stringsim(as.character(NimedKoodita[i]),
as.character(lisaandmedNimed))
#kui üle minSimi väärtuse skoore pole, siis return NA
if(length(dists[dists>=minSim])==0) {
nimed[i]=NA
regkoodid[i]=NA
maxSimilarity[i]=NA
cat("Sarnase nime otsimine. Töötan juhtumi", i, "kallal",
paste0(length(NimedKoodita), "-st \n"))
} else {
maxSim=max(dists[dists>=minSim])#maksimaalne sarnasus
#kui on mitu vastet, siis valin esimese, praegu igatahes töötab
nimed[i]=as.character(lisaandmedNimed[which(dists==maxSim)])[1]
regkoodid[i]=as.character(lisaandmedRegkood[which(dists==maxSim)])[1]
maxSimilarity[i]=dists[dists==maxSim][1]
cat("Sarnase nime otsimine. Töötan juhtumi", i, "kallal",
paste0(length(NimedKoodita), "-st \n"))
}
}
data.frame(NimedKoodita,nimed,regkoodid, maxSimilarity)
}
#funktsioon, mis esialgu leiab sarnasuse otsese matchimise teel,
#seejärel läheb stringi sarnasusi vaatama
RegKoodiLeidja=function(AsutNimed, lisaandmedNimed, lisaandmedRegkood,
minSim=0.78) {
#input:
#-AsutNimed(char/factor vector)=asutuste nimed, millele otsime regkoodi
#-lisaandmedNimed(char/factor vector)=nimed, millel on regkood olemas, andme-
#tabel, kust otsime vasteid
#-lisaandmedRegkood(factor/numeric vector)=regkoodid, mille järjekord on
#sama kui lisaandmedNimed
#-minSim (numeric)=minimaalne sarnasus, mis peab olema, et üldse kaaluks
#sarnasuse otsimisest kahe stringi vahel. Kui kõik sarnasuse skoorid on
#alla selle väärtuse tagastab väärtuse NA
#output:
#-regkoodid (character vector), mis on samas järjekorrask kui AsutNimed
AsutNimed=tolower(AsutNimed)
lisaandmedNimed=tolower(lisaandmedNimed)
#lihtne match
tulem=lisaandmedRegkood[match(AsutNimed, lisaandmedNimed)]
cat("Üks ühele leidsin vaste", sum(!is.na(tulem)),
"nimele, lähen sarnasusi otsima", sum(is.na(tulem)), "nimele \n")
#eemaldame andmetest sodi
lisaandmedNimed=gsub("sihtasutus|^sa | sa$|[[:punct:]]","",lisaandmedNimed)
lisaandmedNimed=trimws(lisaandmedNimed, which = c("both"))#eemaldame tühikud
AsutNimedPuht=gsub("sihtasutus|^sa | sa$|[[:punct:]]","",AsutNimed)
AsutNimedPuht=trimws(AsutNimedPuht, which = c("both"))
#proovime stringmatchi
tulem[is.na(tulem)]=SimMatch(
NimedKoodita =AsutNimedPuht[is.na(tulem)],lisaandmedNimed,
lisaandmedRegkood, minSim = minSim)$regkoodid
as.character(tulem)
}
#testime
proov=RegKoodiLeidja(AsutNimed = asutused, lisaandmedNimed = statAmet$NIMI,
lisaandmedRegkood = statAmet$REGISTRIKOOD)
AsutRegkood=RegKoodiLeidja(AsutNimed = asutused, lisaandmedNimed = statAmet$NIMI,
lisaandmedRegkood = statAmet$REGISTRIKOOD)
AsutRegkood=data.frame(AsutRegkood, unique(andmedLai$allasutus))
View(AsutRegkood)
View(AsutRegkood)
View(AsutRegkood)
AsutRegkood=data.frame(regkood=AsutRegkood, nimi=unique(andmedLai$allasutus))
View(AsutRegkood)
View(AsutRegkood)
AsutRegkood=RegKoodiLeidja(AsutNimed = asutused, lisaandmedNimed = statAmet$NIMI,
lisaandmedRegkood = statAmet$REGISTRIKOOD)
AsutRegkood=data.frame(regkood=AsutRegkood, nimi=unique(andmedLai$allasutus))
View(AsutRegkood)
length(unique(AsutRegkood$regkood))
sum(is.na(AsutRegkood$regkood))
source("helpers.R")
#enne korrigeerisin andmeid käsitsi, kuna veerud on kohati paigast ära
toetused=read.csv2("./andmed/struktuuritoetused_2016-08-10.csv")
toetused$toetuse_andja=gsub(" \\(muu abi rü\\)| norra rü ","",
tolower(toetused$toetuse_andja))
toetused$toetuse_andja=gsub("aktsiaselts","", toetused$toetuse_andja)
#paneme andjatele regkoodid juurde
andjaNimi=unique(toetused$toetuse_andja)
andjaRegkood=RegKoodiLeidja(AsutNimed = andjaNimi,
lisaandmedNimed = statAmet$NIMI,
lisaandmedRegkood = statAmet$REGISTRIKOOD)
struktAnjaNimiRegkood=data.frame(andjaNimi, andjaRegkood)
#mergime kokku
toetused=merge(toetused, struktAnjaNimiRegkood, by.x = "toetuse_andja",
by.y="andjaNimi", all.x = T)
#teeme tabelid erimevate summaarsete asjade kohta
ItMeetmed=c("3.2.12 Info- ja kommunikatsioonitehnoloogiate teadus- ja arendustegevuse toetamine",
"1.2.5 Kohandumine teadmistepõhise majandusega",
"3.5.1 Infoühiskonna teadlikkuse tõstmise programm",
"4.5 Infoühiskonna arendamine",
"2014-2020.12.3 Avalike teenuste pakkumise arendamine",
"3.5.2 Infoühiskonna edendamine avatud taotluste kaudu",
"2014-2020.11.2 Nutika teenuste taristu arendamine",
"3.5.3 Infoühiskonna edendamine investeeringute kavade kaudu")
#hoiame alles ainult read, mis vastavad neile
toetusedIt=toetused[toetused$meetme_kood_koos_nimetusega%in%ItMeetmed,]
#saaja lõikes summa
library(dplyr)
SaajaSummaIT=toetusedIt%>%
group_by(toetuse_saaja_nimi)%>%
summarise(summa=sum(projekti_toetus),
keskmine=mean(projekti_toetus),
mediaan=median(projekti_toetus))
#osakaal
SaajaSummaIT$OsakaalSummast=SaajaSummaIT$summa/sum(SaajaSummaIT$summa)
hist(SaajaSummaIT$Osakaal)
#plotime suuremad saajad
library(ggplot2)
ggplot(SaajaSummaIT[SaajaSummaIT$Osakaal>0.01,], aes(
x=reorder(toetuse_saaja_nimi, summa),y=summa/1000000,
label=paste0(round(Osakaal*100,1),"%")))+
geom_bar(stat="identity", fill="lightblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
ylab("Summa (mln €)")+
geom_text(aes(y = summa/1000000+1))
#plotime keskmise toetuse summa
ggplot(SaajaSummaIT[SaajaSummaIT$keskmine>100000,],
aes(x=reorder(toetuse_saaja_nimi, keskmine),y=keskmine/1000000,
label=round(keskmine/1000000,3)))+
geom_bar(stat="identity", fill="lightblue")+
theme_minimal()+
ylab("Summa (mln €)")+
geom_text(aes(y = keskmine/1000000+0.06))+
coord_flip()
#plotime kogu summa osakaalu järgi keskmise toetuse
ggplot(SaajaSummaIT, aes(x=Osakaal, y=keskmine/100000))+
geom_point()+
theme_minimal()+
geom_text(aes(label = toetuse_saaja_nimi), check_overlap = T,
hjust = 0)
ggplot(SaajaSummaIT, aes(x=OsakaalSummast, y=keskmine/100000))+
geom_point()+
theme_minimal()+
geom_text(aes(label = toetuse_saaja_nimi), check_overlap = T,
hjust = 0)
ggplot(SaajaSummaIT[SaajaSummaIT$keskmine>100000,],
aes(x=reorder(toetuse_saaja_nimi, keskmine),y=keskmine/1000000,
label=round(keskmine/1000000,3)))+
geom_bar(stat="identity", fill="lightblue")+
theme_minimal()+
ylab("Summa (mln €)")+
geom_text(aes(y = keskmine/1000000+0.06))+
coord_flip()
ggplot(SaajaSummaIT[SaajaSummaIT$OsakaalSummast>0.01,], aes(
x=reorder(toetuse_saaja_nimi, summa),y=summa/1000000,
label=paste0(round(OsakaalSummast*100,1),"%")))+
geom_bar(stat="identity", fill="lightblue")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
ylab("Summa (mln €)")+
geom_text(aes(y = summa/1000000+1))
source("helpers.R")
kupsusTase=KupsusTaseAsutus(andmedPikk = andmedPikk, andmedLai = andmedLai)
#paneme ka juurde ka regkoodid
Koond=merge(kupsusTase, AsutRegkood, by.x="allasutus", by.y="nimi")
library(riigiteenused)
source("helpers.R")
andmedLai=andmedSisse()
andmedPikk=andmedPikaks(andmedLai)
asutused=unique(andmedLai$allasutus)
#statameti andmebaas
statAmet=read.csv2("./andmed/StatametiMajAktiivsed01.12.2015.csv")
#hoiame muutujad, mis vajalikud
statAmet=statAmet[,c("REGISTRIKOOD", "NIMI")]
#paneme asutustele regkoodid juurde
AsutRegkood=RegKoodiLeidja(AsutNimed = asutused,
lisaandmedNimed = statAmet$NIMI,
lisaandmedRegkood = statAmet$REGISTRIKOOD)
AsutRegkood=data.frame(regkood=AsutRegkood,
nimi=unique(andmedLai$allasutus),
stringsAsFactors = F)
#käsitsi juurde neile, kellele ei leidnud
AsutRegkood[AsutRegkood$nimi==
"C. R. Jakobsoni Talumuuseum", "regkood"]="70002584"
AsutRegkood[AsutRegkood$nimi==
"Tööstusomandi apellatsioonikomisjon", "regkood"]="70000898"#jumi kood!!!
AsutRegkood[AsutRegkood$nimi==
"Eesti Sõjamuuseum", "regkood"]="70006139"
sum(is.na(AsutRegkood$regkood))
kupsusTase=KupsusTaseAsutus(andmedPikk = andmedPikk, andmedLai = andmedLai)
#paneme ka juurde ka regkoodid
Koond=merge(kupsusTase, AsutRegkood, by.x="allasutus", by.y="nimi")
View(Koond)
RegkoodSummaIT=toetusedIt%>%
group_by(toetuse_saaja_registri_kood)%>%
summarise(summa=sum(projekti_toetus),
keskmine=mean(projekti_toetus),
mediaan=median(projekti_toetus))
RegkoodSummaIT$OsakaalSummast=RegkoodSummaIT$summa/sum(RegkoodSummaIT$summa)
View(Koond)
View(RegkoodSummaIT)
Koond=merge(Koond, RegkoodSummaIT, by.x="regkood",
by.y="toetuse_saaja_registri_kood", all.x=T)
View(Koond)
library(ggplot2)
View(Koond)
ggplot(Koond, aes(x=kupsus, y=summa))+
geom_boxplot()
ggplot(Koond, aes(x=factor(kupsus), y=summa))+
geom_boxplot()
ggplot(Koond, aes(x=factor(kupsus), y=summa/1000000))+
geom_boxplot()+
ylab("Summa (mln €)")
ggplot(Koond, aes(x=factor(kupsus), y=mediaan/1000))+
geom_boxplot()+
ylab("Summa (tuh €)")
ggplot(Koond, aes(x=factor(kupsus), y=keskmine/1000))+
geom_boxplot()+
ylab("Mediaan summa (tuh €)")
ggplot(Koond, aes(x=factor(kupsus), y=OsakaalSummast))+
geom_boxplot()+
ylab("Osakaal kogu toetuse summast")
ggplot(Koond, aes(x=factor(kupsus), y=teenusteArv))+
geom_boxplot()+
ylab("Teenuste arv")
Koond[is.na(Koond)]==0
View(Koond)
Koond[is.na(Koond)]<-0
View(Koond)
ggplot(Koond, aes(x=factor(kupsus), y=summa/1000000))+
geom_boxplot()+
ylab("Summa (mln €)")
ggplot(Koond, aes(x=factor(kupsus), y=mediaan/1000))+
geom_boxplot()+
ylab("Mediaan summa (tuh €)")
ggplot(Koond, aes(x=factor(kupsus), y=keskmine/1000))+
geom_boxplot()+
ylab("Keskmine summa (tuh €)")
ggplot(Koond, aes(x=factor(kupsus), y=OsakaalSummast))+
geom_boxplot()+
ylab("Osakaal kogu toetuse summast")
ggplot(Koond, aes(x=factor(kupsus), y=teenusteArv))+
geom_boxplot()+
ylab("Teenuste arv")
andmedLai$OnOmanik=ifelse(andmedLai$omanikunimi==""&
andmedLai$omanikuamet==""&
andmedLai$omanikuemail==""&
andmedLai$omanikutelefon=="", 0, 1)
library(dplyr)
OmanikAsutusLoikes=andmedLai%>%
group_by(ministeerium, allasutus)%>%
summarise(omanikOsakaal = round(mean(OnOmanik)*100),
teenusteArv=length(OnOmanik))
View(OmanikAsutusLoikes)
moodikAsutusLoikes=andmedPikk %>%
group_by(ministeerium,allasutus) %>%
summarise(onMoodik=sum(!is.na(value)),
moodikArv=n())%>%
mutate(moodikOsakaal=onMoodik/moodikArv)
View(moodikAsutusLoikes)
View(moodikAsutusLoikes)
moodikAsutusLoikes=merge(moodikAsutusLoikes, AsutRegkood, by.x="allasutus",
by.y="nimi")
View(moodikAsutusLoikes)
OmanikAsutusLoikes=merge(OmanikAsutusLoikes, AsutRegkood, by.x="allasutus",
by.y="nimi")
View(OmanikAsutusLoikes)
OmanikAsutusLoikes=andmedLai%>%
group_by(ministeerium, allasutus)%>%
summarise(omanikOsakaal = round(mean(OnOmanik)*100),
teenusteArv=length(OnOmanik))
#mõõdikute osakaal
moodikAsutusLoikes=andmedPikk %>%
group_by(ministeerium,allasutus) %>%
summarise(onMoodik=sum(!is.na(value)),
moodikArv=n())%>%
mutate(moodikOsakaal=onMoodik/moodikArv)
#regkoodid juurde
moodikAsutusLoikes=merge(moodikAsutusLoikes, OmanikAsutusLoikes, by.x="allasutus",
by.y="allasutus")
View(moodikAsutusLoikes)
OmanikAsutusLoikes=andmedLai%>%
group_by(ministeerium, allasutus)%>%
summarise(omanikOsakaal = mean(OnOmanik),
teenusteArv=length(OnOmanik))
#mõõdikute osakaal
moodikAsutusLoikes=andmedPikk %>%
group_by(ministeerium,allasutus) %>%
summarise(onMoodik=sum(!is.na(value)),
moodikArv=n())%>%
mutate(moodikOsakaal=onMoodik/moodikArv)
#regkoodid juurde
moodikAsutusLoikes=merge(moodikAsutusLoikes, OmanikAsutusLoikes, by.x="allasutus",
by.y="allasutus")
View(moodikAsutusLoikes)
OmanikAsutusLoikes=merge(moodikAsutusLoikes, AsutRegkood, by.x="allasutus",
by.y="nimi")
View(OmanikAsutusLoikes)
OmanikAsutusLoikes=OmanikAsutusLoikes[,c("regkood", "omanikOsakaal","moodikOsakaal")]
moodikAsutusLoikes=merge(moodikAsutusLoikes, AsutRegkood, by.x="allasutus",
by.y="nimi")
moodikAsutusLoikes=moodikAsutusLoikes[,c("regkood", "omanikOsakaal","moodikOsakaal")]
#regkoodid juurde
OmanikAsutusLoikes=andmedLai%>%
group_by(ministeerium, allasutus)%>%
summarise(omanikOsakaal = mean(OnOmanik),
teenusteArv=length(OnOmanik))
#mõõdikute osakaal
moodikAsutusLoikes=andmedPikk %>%
group_by(ministeerium,allasutus) %>%
summarise(onMoodik=sum(!is.na(value)),
moodikArv=n())%>%
mutate(moodikOsakaal=onMoodik/moodikArv)
moodikAsutusLoikes=merge(moodikAsutusLoikes, OmanikAsutusLoikes, by.x="allasutus",
by.y="allasutus")
moodikAsutusLoikes=merge(moodikAsutusLoikes, AsutRegkood, by.x="allasutus",
by.y="nimi")
View(moodikAsutusLoikes)
proov=moodikAsutusLoikes[c("regkood", "omanikOsakaal","moodikOsakaal")]
View(proov)
proov=moodikAsutusLoikes[,c("regkood", "omanikOsakaal","moodikOsakaal")]
View(moodikAsutusLoikes)
names(moodikAsutusLoikes)
moodikAsutusLoikes$omanikOsakaal
moodikAsutusLoikes$moodikOsakaal
moodikAsutusLoikes$regkood
moodikAsutusLoikes[,c("regkood")]
moodikAsutusLoikes[,"regkood"]
class(moodikAsutusLoikes)
moodikAsutusLoikes[, c("regkood", "omanikOsakaal","moodikOsakaal"), with = FALSE]
moodikAsutusLoikes=moodikAsutusLoikes[, c("regkood", "omanikOsakaal","moodikOsakaal"), with = FALSE]
View(moodikAsutusLoikes)
names(Koond)
Koond=merge(Koond, moodikAsutusLoikes, by.x="regkood", by.y="regkood")
View(Koond)
Koond$KupsusSkoor=Koond$omanikOsakaal+Koond$moodikOsakaal
ggplot(Koond, aes(x=KupsusSkoor, y=summa/1000000))+
geom_point()+
ylab("Summa (mln €)")
ggplot(Koond, aes(x=KupsusSkoor, y=mediaan/1000))+
geom_point()+
ylab("Mediaan summa (tuh €)")
ggplot(Koond, aes(x=kupsus, y=keskmine/1000))+
geom_point()+
ylab("Keskmine summa (tuh €)")
ggplot(Koond, aes(x=kupsusSkoor, y=keskmine/1000))+
geom_point()+
ylab("Keskmine summa (tuh €)")
ggplot(Koond, aes(x=KupsusSkoor, y=keskmine/1000))+
geom_point()+
ylab("Keskmine summa (tuh €)")
ggplot(Koond, aes(x=KupsusSkoor, y=OsakaalSummast))+
geom_point()+
ylab("Osakaal kogu toetuse summast")
#teenuste arv
ggplot(Koond, aes(x=kupsus, y=teenusteArv))+
geom_point()+
ylab("Teenuste arv")
ggplot(Koond, aes(x=KupsusSkoor, y=teenusteArv))+
geom_point()+
ylab("Teenuste arv")
library(ggplot2)
library(dplyr)
rhr=readRDS("./andmed/rhrKoond.RDS")
rhrAsut=rhr%>%
group_by(Reg..kood)%>%
summarise(meanEelM=mean(eeldatav_maksumus),
meanLepM=mean(lepingu_maksumus),
meanTegM=mean(tegelik_maksumus),
meanPer=mean(kestvus_kuudes))
#paneme koondisse juurde
Koond=merge(Koond, rhrAsut, by.x="regkood", by.y="Reg..kood", all.x = T)
#plotime
ggplot(Koond, aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(TegLepM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(meanTegM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()
rhr=readRDS("./andmed/rhrKoond.RDS")
rhrAsut=rhr%>%
group_by(Reg..kood)%>%
summarise(meanEelM=mean(eeldatav_maksumus),
meanLepM=mean(lepingu_maksumus),
meanTegM=mean(tegelik_maksumus),
meanPer=mean(kestvus_kuudes),
medEelM=median(eeldatav_maksumus),
medLepM=median(lepingu_maksumus),
medTegM=median(tegelik_maksumus),
medPer=median(kestvus_kuudes))
#paneme koondisse juurde
Koond=merge(Koond, rhrAsut, by.x="regkood", by.y="Reg..kood", all.x = T)
ggplot(Koond, aes(x=log(medEelM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(medLepM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(medTegM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=meanPer, y=KupsusSkoor))+
geom_point()+
geom_smooth()
names(Koond)
Koond=merge(kupsusTase, AsutRegkood, by.x="allasutus", by.y="nimi")
#paneme juurde Struktuuri toetuste andmed
Koond=merge(Koond, RegkoodSummaIT, by.x="regkood",
by.y="toetuse_saaja_registri_kood", all.x=T)
#kus summad puudu paneme 0
Koond[is.na(Koond)]<-0
Koond=merge(Koond, moodikAsutusLoikes, by.x="regkood", by.y="regkood")
Koond$KupsusSkoor=Koond$omanikOsakaal+Koond$moodikOsakaal
Koond=merge(Koond, pohipalkAsut, by.x="regkood", by.y="regkood", all.x = T)
Koond$Asutus=NULL
Koond=merge(Koond, rhrAsut, by.x="regkood", by.y="Reg..kood", all.x = T)
ggplot(Koond, aes(x=meanPer, y=KupsusSkoor))+
geom_point()+
geom_smooth()
ggplot(Koond, aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()
ggplot(Koond, aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()
ggplot(Koond, aes(x=meanPer, y=KupsusSkoor))+
geom_point()+
geom_smooth()
#mean keskmine lepingu periood vs kupsusskoor
ggplot(Koond, aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()
View(Koond)
ggplot(Koond, aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ministeerium, scales = "free")
namesKoond
names(Koond)
ggplot(Koond, aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond, aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()
ggplot(Koond, aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium)
ggplot(Koond, aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond, aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond, aes(x=meanLepM, y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond, aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free_x" )
ggplot(Koond, aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free_y" )
ggplot(Koond, aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free", na.rm=T )
ggplot(Koond, aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanLepM)], aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanLepM),], aes(x=log(meanLepM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanEelM),], aes(x=log(meanEelM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.an(Koond$meanTegM),], aes(x=log(meanTegM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanTegM),], aes(x=log(meanTegM), y=KupsusSkoor))+
geom_point()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanPer),], aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond, aes(x=log(medEelM), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$medEelM),], aes(x=log(medEelM), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$medLepM),], aes(x=log(medLepM), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$medTegM),], aes(x=log(medTegM), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanPer),], aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")
ggplot(Koond[!is.na(Koond$meanPer),], aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")+
coord_cartesian(ylim=c(0,2))
ggplot(Koond[!is.na(Koond$meanPer),], aes(x=log(meanPer), y=KupsusSkoor))+
geom_point()+
geom_smooth()+
facet_wrap(~ ministeerium, scales = "free")+
coord_cartesian(ylim=c(0,2))
